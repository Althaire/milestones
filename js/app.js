!function(a,b,c,d){"use strict";function e(b,c){var d,e=a.Deferred();try{d=JSON.parse(localStorage.getItem(b))}catch(f){}return d&&c?c?e.notify(d):e.resolve(d):c||e.reject(),c().done(function(a){try{localStorage.setItem(b,JSON.stringify(a))}catch(c){}}).done(function(a){e.resolve(a)}),e.promise()}function f(a,b){var c,d;b=b.reduce(function(a,b){return a[b.login]=b,a},{}),c={},d=a.reduce(function(a,b){c.name!==b.milestone&&(c={name:b.milestone,effort:{done:0,inprogress:0,backlog:0}},a.push(c));var d=b.status.toLowerCase().replace(/[^\w]/g,""),e=parseInt(b.estimate,10);return c.effort[d]+=e,a},[]),c="",a=a.map(function(a){var d=b[a.owner];return c===a.milestone?a.milestone="":c=a.milestone,a.link=a.issue&&a.issue.replace(/([^\/]+)\/([^#]+)#()/,"https://github.com/$1/$2/issues/$3"),a.dependsOn=(a.dependsOn||"").replace(/\n/g,"<br>"),a.ownerUrl=d&&d.url,a.ownerAvatarUrl=d&&d.avatar_url+"s=24",a.ownerName=d&&d.login,a}),g(d),h(a)}function g(b){var d,e,f=0;b=b.map(function(a){return a.total=a.effort.done+a.effort.inprogress+a.effort.backlog,a.donePercent=parseInt(a.effort.done/a.total*100,10),a.inProgressPercent=parseInt(a.effort.inprogress/a.total*100,10),a}),d=b.reduce(function(a,b){return a+b.total},0),e=b.map(function(a){return a.total=a.total/d*100,f+=a.total,c.template(k,c.extend({},a,{preceding:f-a.total}))}).join("\n"),a(".chart").html(e)}function h(b){var d=b.map(c.template.bind(null,j)).join("\n");a("tbody").html(d)}function i(a){window.console.log(a)}var j="";j+='<tr class="<%= milestone ? "newMilestone" : "" %>">\n',j+='    <th class="milestone">\n',j+="        <%= milestone %>\n",j+="    </th>\n",j+='    <td class="task">\n',j+="        <% if (link) { %>",j+='        <a href="<%= link %>">\n',j+="            <%= title %>\n",j+="        </a>\n",j+="        <% } else { %>\n",j+="        <%= title %>\n",j+='        <small class="badge badge-info">missing issue</small>\n',j+="        <% } %>\n",j+="    </td>\n",j+='    <td class="owner">\n',j+='        <a href="<%= ownerUrl %>">\n',j+='            <img src="<%= ownerAvatarUrl %>" alt="<%= ownerName %>">\n',j+="        </a>\n",j+="    </td>\n",j+='    <td class="estimate">\n',j+="        <%= estimate %>\n",j+="    </td>\n",j+='    <td class="status">\n',j+="        <%= status %>\n",j+="    </td>\n",j+="</tr>";var k="";k+='<div class="progress" style="width: <%= total %>%; left: <%= preceding %>%;">',k+='  <div class="progress-bar" style="width: <%= donePercent %>%">',k+='    <span class="sr-only">done</span>',k+="  </div>",k+='  <div class="progress-bar progress-bar-striped active" style="width: <%= inProgressPercent %>%">',k+='    <span class="sr-only">20% Complete (warning)</span>',k+="  </div>",k+="</div>",d.setup({googleScriptId:"AKfycbzkbQC8WAEIRDI6KKD0GNJWXVGuvRaBKTv3guT_n-pRCgav1Hev"}),a.when(e("tasks",d.findAllTasks),e("owners",githubApi.org("hoodiehq").members.findAll)).progress(f).done(f).fail(i)}(jQuery,initials,_,milestonesApi);